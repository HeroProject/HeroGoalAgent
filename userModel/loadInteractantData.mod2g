use '../util/*.pl' as knowledge.
use '../minidialogs/*.pl' as knowledge.
use '../minidialogs/co_creation/*.pl' as knowledge.
use '../minidialogs/hospital/*.pl' as knowledge.
use '../minidialogs/robotstories/*.pl' as knowledge.
use '../sessions' as knowledge.
use '../hero_actions' as actionspec.
use loadInteractantDataHelper as module.

order=linearall.

module loadInteractantData(Minidialog) {
	if bel(userId(UserId))
		then {
			% Load text variables
			forall bel(text(Minidialog, _, Text), split_string(Text, '%', "", TextParts), odd_elements(TextParts, Keys))
				do loadInteractantDataHelper(Keys).
			
			% Load motions
			forall bel(anim(Minidialog, _, id, Key))
				do getInteractantData(UserId, Key).
			
			% Load audio
			forall bel(audio(Minidialog, _, id, Key))
				do getInteractantData(UserId, Key).
			
			% Load led animations
			forall bel(leds(Minidialog, _, id, Key))
				do insert(waitingForMemoryLed(Key)) + getInteractantData(UserId, Key).
			
			% Load variables for nested minidialogs
			forall bel(insert_minidialog(Minidialog, Move, NestedMinidialog), keyValue(Minidialog, Move, loadUserModel, "true"))
				do loadInteractantData(NestedMinidialog).
		}
}